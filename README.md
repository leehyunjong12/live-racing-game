# 🚀 실시간 자동차 경주

2주차 자동차 경주 미션을 Spring Boot, WebSocket 기반의 '실시간 그래프 기반 웹 애플리케이션'으로 확장하는 프로젝트

v1.0에서 '실시간 1D 플랫폼'을 구축

v2.0에서는 '그래프(Graph)' 기반의 복잡한 맵 로직과 '동적 맵 전송' 아키텍처를 구현

v3.0에서는 서비스 운영 및 금융 시스템 도입

---

### 🛠️ 기술 스택

* **Backend:** Java 21, Spring Boot, WebSocket, JSON 라이브러리
* **Frontend:** HTML5 'canvas', CSS, JavaScript
* **Build:** Gradle

---

### ✅ v1.0: 1D 실시간 플랫폼 (구현 완료)

> (v1.0은 1차원 `div` 이동 방식으로, v2.0부터는 `canvas` 기반으로 재구축)

**Backend**
- [x] Spring Boot 기반의 웹 서버 실행
- [x] WebSocket 엔드포인트 활성화
- [x] 클라이언트 접속 시 WebSocket 세션 연결 및 관리
- [x] 클라이언트가 보낸 `START` 메시지 수신 및 처리
- [x] 자동차들 random 값에 의한 경주 기능 구현
- [x] 경주 상태, 우승자 추출 JSON 문자열로 변환
- [x] 경주가 진행되는 동안, 연결된 모든 클라이언트에게 JSON 데이터 **실시간 방송(Broadcast)**

**Frontend**
- [x] 경기장 뼈대 및 CSS 스타일링
- [x] WebSocket 클라이언트로 서버 엔드포인트 접속
- [x] WebSocket 연결 성공 시 '경주 시작' 버튼 활성화
- [x] '경주 시작' 버튼 클릭 시, 서버로 `START` 메시지 전송
- [x] 서버로부터 실시간으로 방송되는 JSON 데이터 수신
- [x] 수신한 데이터를 기반으로 실시간 애니메이션 구현
- [x] 트랙 초기화 버튼 구현

---
### ✅ v2.0: 그래프(Graph) 맵 및 아키텍처 리팩토링 (구현 완료)

v1의 한계를 극복하기 위해 v2.0에서는 아키텍처를 재설계하고 그래프(Graph) 기반의 맵을 도입

**Backend**
- [x] 그래프 맵 기능 구현 (갈림길)
- [x] 특수 칸 기능 구현(지름길,장애물,후진)
- [x] 맵 전송을 위한 DTO(Data Transfer Object) 설계
- [x] 클라이언트 접속 시 맵 레이아웃(좌표, 선)을 JSON으로 즉시 전송
- [x] '게임 규칙 엔진'이 '그래프' 기반의 다음 위치를 계산하도록 구현
- [x] 한 차라도 결승선에 도착하면 중단하고 우승자 반환 

**Frontend**
- [x] 렌더링 엔진을  `HTML <canvas>` 기반으로 교체
- [x] 서버로부터  JSON을 동적으로 다운로드하여 맵을 생성
- [x] `requestAnimationFrame`을 이용한 1초 60프레임 게임 루프 도입
- [x] 서버에서 받은 '노드 번호'를 맵 좌표의 값으로 변환하여 캔버스에 렌더링
- [x] 캔버스에 '연결 선'과 '노드'를 그려 '그래프 맵'  시각화
- [x] 맵 데이터가 수신되어야 '경주 시작' 버튼 활성화로 변경

---


### ✅ v2.0 수정사항: 몇몇 에러 처리 및 수정 (구현 완료)

**Backend**
- [x] 지름길 노드는 노드 연결 방식으로 충분히 구현 가능 -> 삭제
- [x] 모든 노드가 '다음 노드' 목록을 갖도록 '맵 데이터' 구조 변경
  - 현재 순차적인 방법은 노드 재배치 불가
- [x] 노드 구조 더 다양하게 배치
- [x] 노드 타입 '한턴 감옥', '뒤로 두칸' 무한 루프 발생 해결
  - '한턴 쉬기'는 기능적으로 해결
  - '뒤로 두칸'은 '확률적으로 현재 노드 번호 -2로 이동'로 변경
- [x] '한턴 감옥' -> '두턴 감옥'로 수정
- [x] 노드 타입 '두턴 감옥' -> 확률적으로 가게 변경
- [x] 노드 타입 "시작 노드로 복귀", "중간 숫자 지점 노드들로 이동", "슬라이드" 추가
- [x] 우승자 없이 라운드가 끝났을 때 우승자 없게 수정

**Frontend**
- [x] '두 턴 감옥'시 감옥으로 이동 
- [x] 노드 타입별로 색상 부여
- [x] 노드 타입들 설명 화면에 보여줌
- [x] 라운드 상황 및 전진 실패 조건 화면에 표시
- [x] 우승자 결과 보드 UI 구현
- [x] 경주 종료 시 우승자 알림창 및 축하 애니메이션 적용
- [x] 무한 루프 선 변경
--- 


### ✅ v3.0 서비스 운영 및 금융 시스템 도입 (현재)

**Backend**
- [x] 데이터 베이스 및 환경 구축
- [x] 핵심 엔티티 및 레포지토리 설계(사용자 정보, 등록 차량, 총상금)
- [x] 사용자 인증 및 인가 시스템 구축
- [x] 회원가입 기능 구현
- [x] 로그인, 로그아웃 및 세션 관리 구현 
- [x] 잔액 충전 및 조회 기능 구현
- [x] 로그인 된 사용자가 여러 대 자동차 등록 기능 구현
- [x] 등록 차량 수에 따라 잔액에서 차감 및 상금에 추가 기능 구현
- [x] 우승자 발생시, 상금 지급, 상금 초기화, 모든 자동차 정보 삭제 기능 구현
- [x] 실제 시간 5분마다 경주 자동 시작 기능 구현
- [ ] 본인 차 특수 노드 진입 시 발생 이벤트 메시지를 수집하여 JSON에 포함

**Frontend**
- [x] 회원가입 및 로그인, 로그아웃 폼,버튼 구현
- [x] 로그인 시 화면 상단 닉네임 표시
- [x] 잔액 충전 입력 폼 및 연동 구현
- [x] 사용자 전용 자동차 등록 폼 구현
- [x] 경주 자동차들을 데이터베이스 자동차로 변경 (본인 자동차에만 색상 부여)
- [x] 사용자가 등록한 자동차 대수 닉네임 옆 표시
- [x] 누적 총 상금 금액 표시 UI 구현
- [x] 경기가 진행하지 않을 때 라운드 영역은 경기 시작까지 남은시간 타이머로 전환
- [ ] 경주 시작 10초 전 자동차 등록, 잔액 충전 폼,로그 아웃 자동 비활성화
- [ ] 경주 자동 10초 전 경기화면 초기화 기능 구현
- [ ] 경기 시작 3초전, 화면 중앙에"3,2,1" 애니메이션 구현
- [ ] 특수 노드 이벤트 메시지를 화면의 전용 로그 영역에 실시간으로 표시.
---
